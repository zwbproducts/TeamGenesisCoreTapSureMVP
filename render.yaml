services:
  - type: web
    name: tapsure-backend
    env: python
    plan: free
    buildCommand: "pip install -r backend/requirements.txt"
    startCommand: "cd backend && PYTHONPATH=. uvicorn app.main:app --host 0.0.0.0 --port $PORT"
    autoDeploy: true
    envVars:
      - key: POS_QR_ENFORCEMENT
        value: "off"
      - key: POS_REQUIRE_QR
        value: "0"
      - key: POS_QR_MAX_AGE_SECONDS
        value: "900"
      - key: POS_QR_NONCE_TTL_SECONDS
        value: "3600"
      - key: POS_TENANT_SECRETS
        value: '{"demo":"dev-secret","customer":"secret1","merchant":"secret2","insurer":"secret3"}'
      - key: TESSDATA_PREFIX
        value: "/usr/share/tesseract-ocr/5/tessdata"
    healthCheckPath: /health
    repo: https://github.com/turnzero666/TapSureAppDebug
    branch: main
